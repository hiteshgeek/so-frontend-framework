<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Tutorials - SixOrbit ERP</title>

    <!-- Prevent sidebar blink on page load -->
    <script>
    (function() {
        try {
            var state = localStorage.getItem('so-sidebar-state');
            if (state === 'pinned') {
                document.documentElement.classList.add('sidebar-ready', 'sidebar-pinned');
            } else {
                document.documentElement.classList.add('sidebar-ready', 'sidebar-collapsed');
            }
        } catch(e) {
            document.documentElement.classList.add('sidebar-ready', 'sidebar-collapsed');
        }
    })();
    </script>

    <!-- Prevent theme flash on page load -->
    <script>
    (function() {
        try {
            var theme = localStorage.getItem('so-theme-preference') || 'sidebar-dark';
            var effectiveTheme = theme;

            if (theme === 'sidebar-dark') {
                effectiveTheme = 'light';
                document.addEventListener('DOMContentLoaded', function() {
                    var sidebar = document.querySelector('.so-sidebar');
                    if (sidebar) sidebar.classList.add('sidebar-dark');
                });
            } else if (theme === 'system') {
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    effectiveTheme = 'dark';
                } else {
                    effectiveTheme = 'light';
                }
            }

            document.documentElement.setAttribute('data-theme', effectiveTheme);

            // Apply font size immediately to prevent flash
            var fontsize = localStorage.getItem('so-fontsize-preference');
            if (fontsize && fontsize !== 'default') {
                document.documentElement.setAttribute('data-fontsize', fontsize);
            }
        } catch(e) {
            document.documentElement.setAttribute('data-theme', 'light');
            document.addEventListener('DOMContentLoaded', function() {
                var sidebar = document.querySelector('.so-sidebar');
                if (sidebar) sidebar.classList.add('sidebar-dark');
            });
        }
    })();
    </script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=Google+Sans+Text:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- SixOrbit Common Styles -->
    <link rel="stylesheet" href="../common/sixorbit-common.css">

    <!-- SixOrbit UI Components -->
    <link rel="stylesheet" href="css/so-theme.css">
    <link rel="stylesheet" href="css/so-navbar.css">
    <link rel="stylesheet" href="css/so-sidebar.css">
    <link rel="stylesheet" href="css/so-panel.css">
    <link rel="stylesheet" href="css/so-forms.css">
    <link rel="stylesheet" href="css/so-lms.css">
</head>
<body>

    <!-- ============================================
         SIDEBAR
         ============================================ -->
    <aside class="so-sidebar">
        <div class="so-sidebar-header">
            <div class="so-sidebar-logo">TI</div>
            <div class="so-sidebar-brand-info">
                <div class="so-sidebar-brand-name">Trove Innovation</div>
            </div>
            <button class="so-sidebar-toggle" title="Pin sidebar">
                <span class="toggle-circle"></span>
            </button>
        </div>

        <div class="so-sidebar-scroll">
            <ul class="so-sidebar-nav">
                <!-- Menu items will be loaded dynamically -->
            </ul>
        </div>

        <div class="so-sidebar-footer" data-server-ip="139.59.29.99" data-version="5.9" data-company-id="166262" data-licence-id="410002934">
            <div class="so-sidebar-footer-buttons">
                <button class="so-sidebar-footer-btn" id="sidebarInfoBtn" title="Connection Info">
                    <span class="material-icons">info_outline</span>
                </button>
                <button class="so-sidebar-footer-btn" id="sidebarFullscreenBtn" title="Fullscreen">
                    <span class="material-icons">fullscreen</span>
                </button>
                <button class="so-sidebar-footer-btn" id="sidebarSwitchCompanyBtn" title="Switch Company">
                    <span class="material-icons">swap_horiz</span>
                </button>
                <button class="so-sidebar-footer-btn" id="sidebarLogoutBtn" title="Logout">
                    <span class="material-icons">power_settings_new</span>
                </button>
            </div>
        </div>
    </aside>

    <!-- Sidebar Overlay (for mobile) -->
    <div class="so-sidebar-overlay"></div>

    <!-- ============================================
         NAVBAR
         ============================================ -->
    <nav class="so-navbar">
        <div class="so-navbar-container">
            <div class="so-navbar-left">
                <button class="so-navbar-toggle" data-toggle="sidebar" title="Toggle Menu">
                    <span class="material-icons">menu</span>
                </button>
            </div>

            <div class="so-navbar-center">
                <div class="so-navbar-search">
                    <div class="so-navbar-search-wrapper">
                        <span class="material-icons so-navbar-search-icon">search</span>
                        <input type="text" class="so-navbar-search-input" placeholder="Search courses... [CTRL + K]">
                    </div>
                </div>
            </div>

            <div class="so-navbar-right">
                <!-- Keyboard Shortcuts -->
                <button class="so-navbar-icon-btn" id="keyboardShortcutsBtn" title="Keyboard Shortcuts">
                    <span class="material-icons">keyboard</span>
                </button>

                <!-- Theme Switcher -->
                <div class="so-navbar-theme">
                    <button class="so-navbar-icon-btn so-navbar-theme-btn" title="Theme">
                        <span class="material-icons theme-icon">light_mode</span>
                    </button>
                    <div class="so-navbar-theme-dropdown">
                        <div class="so-navbar-theme-header">Appearance</div>
                        <button class="so-navbar-theme-option" data-theme="light">
                            <span class="material-icons">light_mode</span>
                            <span>Light</span>
                            <span class="material-icons theme-check">check</span>
                        </button>
                        <button class="so-navbar-theme-option" data-theme="dark">
                            <span class="material-icons">dark_mode</span>
                            <span>Dark</span>
                            <span class="material-icons theme-check">check</span>
                        </button>
                        <button class="so-navbar-theme-option" data-theme="system">
                            <span class="material-icons">computer</span>
                            <span>System</span>
                            <span class="material-icons theme-check">check</span>
                        </button>
                        <button class="so-navbar-theme-option" data-theme="sidebar-dark">
                            <span class="material-icons">contrast</span>
                            <span>Dark Sidebar</span>
                            <span class="material-icons theme-check">check</span>
                        </button>
                        <div class="so-navbar-theme-divider"></div>
                        <div class="so-navbar-theme-header">Font Size</div>
                        <button class="so-navbar-theme-option" data-fontsize="small">
                            <span class="material-icons">text_decrease</span>
                            <span>Small</span>
                            <span class="material-icons fontsize-check">check</span>
                        </button>
                        <button class="so-navbar-theme-option" data-fontsize="default">
                            <span class="material-icons">format_size</span>
                            <span>Default</span>
                            <span class="material-icons fontsize-check">check</span>
                        </button>
                        <button class="so-navbar-theme-option" data-fontsize="large">
                            <span class="material-icons">text_increase</span>
                            <span>Large</span>
                            <span class="material-icons fontsize-check">check</span>
                        </button>
                    </div>
                </div>

                <div class="so-navbar-divider"></div>

                <!-- User Menu -->
                <div class="so-navbar-user">
                    <button class="so-navbar-user-btn">
                        <div class="so-navbar-user-avatar" data-color="teal">R</div>
                    </button>
                    <div class="so-navbar-user-dropdown">
                        <div class="so-navbar-user-header">
                            <div class="so-navbar-user-header-avatar" data-color="teal">R</div>
                            <div class="so-navbar-user-header-name">Rajeev Chauhan</div>
                            <div class="so-navbar-user-header-email">rajeev@sixorbit.com</div>
                        </div>
                        <div class="so-navbar-user-menu">
                            <a href="index.html" class="so-navbar-user-menu-item">
                                <span class="material-icons">dashboard</span>
                                <span>Go to Dashboard</span>
                            </a>
                        </div>
                        <div class="so-navbar-user-footer">
                            <button class="so-navbar-user-footer-btn" id="navbarFullscreenBtn" title="Fullscreen">
                                <span class="material-icons">fullscreen</span>
                            </button>
                            <button class="so-navbar-user-footer-btn" id="lockScreenBtn" title="Lock Screen">
                                <span class="material-icons">lock</span>
                            </button>
                            <button class="so-navbar-user-footer-btn" id="navbarLogoutBtn" title="Logout">
                                <span class="material-icons">power_settings_new</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- ============================================
         MAIN CONTENT
         ============================================ -->
    <main class="so-main-content">
        <!-- Breadcrumb Bar (inside main content) -->
        <div class="so-breadcrumb-bar" id="lmsBreadcrumbBar">
            <a href="index.html" class="so-breadcrumb-bar-home" title="Dashboard">
                <span class="material-icons">home</span>
            </a>
            <span class="so-breadcrumb-bar-separator">
                <span class="material-icons">chevron_right</span>
            </span>
            <span class="so-breadcrumb-bar-item active">Video Tutorials</span>
        </div>

        <div class="demo-content">
            <!-- Main LMS Container -->
            <div id="lmsContainer">
                <!-- Content will be rendered by JavaScript -->
            </div>
        </div>
    </main>

    <!-- ============================================
         QUIZ OVERLAY (Hidden by default)
         ============================================ -->
    <div class="so-lms-quiz-overlay" id="quizOverlay" style="display: none;">
        <!-- Quiz content will be rendered by JavaScript -->
    </div>

    <!-- ============================================
         LOCK SCREEN OVERLAY
         ============================================ -->
    <div class="so-lock-screen" id="lockScreen">
        <div class="so-lock-screen-container">
            <div class="so-lock-screen-time" id="lockScreenTime">12:00</div>
            <div class="so-lock-screen-date" id="lockScreenDate">Saturday, January 25</div>

            <div class="so-lock-screen-avatar" data-color="teal">R</div>
            <div class="so-lock-screen-name">Rajeev Chauhan</div>
            <div class="so-lock-screen-status">
                <span class="material-icons">lock</span>
                Screen Locked
            </div>

            <form class="so-lock-screen-form" id="lockScreenForm">
                <div class="so-lock-screen-input-wrapper">
                    <input type="password"
                           class="so-lock-screen-input"
                           id="lockScreenPassword"
                           placeholder="Enter password to unlock"
                           autocomplete="off">
                    <button type="submit" class="so-lock-screen-submit" title="Unlock">
                        <span class="material-icons">arrow_forward</span>
                    </button>
                </div>
            </form>

            <div class="so-lock-screen-hint">
                Press Enter or click arrow to unlock
            </div>
        </div>

        <div class="so-lock-screen-branding">
            <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <ellipse cx="24" cy="24" rx="22" ry="10" stroke="currentColor" stroke-width="2" fill="none" transform="rotate(-20 24 24)" opacity="0.6"/>
                <path d="M24 6L38.7 15V33L24 42L9.3 33V15L24 6Z" stroke="currentColor" stroke-width="2.5" fill="none"/>
                <circle cx="24" cy="24" r="4" fill="currentColor"/>
            </svg>
            SixOrbit ERP
        </div>
    </div>

    <!-- ============================================
         KEYBOARD SHORTCUTS POPUP
         ============================================ -->
    <div class="so-shortcuts-overlay" id="shortcutsOverlay">
        <div class="so-shortcuts-popup">
            <div class="so-shortcuts-header">
                <h2>
                    <span class="material-icons">keyboard</span>
                    Keyboard Shortcuts
                </h2>
                <button class="so-shortcuts-close" id="shortcutsCloseBtn" title="Close (Esc)">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="so-shortcuts-content">
                <div class="so-shortcuts-section">
                    <h3>Navigation</h3>
                    <div class="so-shortcut-item">
                        <span class="so-shortcut-desc">Global Search</span>
                        <span class="so-shortcut-keys">
                            <kbd>Ctrl</kbd> + <kbd>K</kbd>
                        </span>
                    </div>
                    <div class="so-shortcut-item">
                        <span class="so-shortcut-desc">Toggle Sidebar</span>
                        <span class="so-shortcut-keys">
                            <kbd>Ctrl</kbd> + <kbd>B</kbd>
                        </span>
                    </div>
                    <div class="so-shortcut-item">
                        <span class="so-shortcut-desc">Go to Dashboard</span>
                        <span class="so-shortcut-keys">
                            <kbd>Ctrl</kbd> + <kbd>H</kbd>
                        </span>
                    </div>
                </div>
                <div class="so-shortcuts-section">
                    <h3>Actions</h3>
                    <div class="so-shortcut-item">
                        <span class="so-shortcut-desc">Lock Screen</span>
                        <span class="so-shortcut-keys">
                            <kbd>Ctrl</kbd> + <kbd>L</kbd>
                        </span>
                    </div>
                    <div class="so-shortcut-item">
                        <span class="so-shortcut-desc">Logout</span>
                        <span class="so-shortcut-keys">
                            <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>L</kbd>
                        </span>
                    </div>
                    <div class="so-shortcut-item">
                        <span class="so-shortcut-desc">Toggle Fullscreen</span>
                        <span class="so-shortcut-keys">
                            <kbd>F11</kbd>
                        </span>
                    </div>
                </div>
                <div class="so-shortcuts-section">
                    <h3>Help</h3>
                    <div class="so-shortcut-item">
                        <span class="so-shortcut-desc">Show Shortcuts</span>
                        <span class="so-shortcut-keys">
                            <kbd>?</kbd>
                        </span>
                    </div>
                    <div class="so-shortcut-item">
                        <span class="so-shortcut-desc">Close Popup</span>
                        <span class="so-shortcut-keys">
                            <kbd>Esc</kbd>
                        </span>
                    </div>
                </div>
            </div>
            <div class="so-shortcuts-footer">
                <span class="material-icons">info</span>
                Press <kbd>?</kbd> anytime to view shortcuts
            </div>
        </div>
    </div>

    <!-- ============================================
         LOGOUT CONFIRMATION POPUP
         ============================================ -->
    <div class="so-confirm-overlay" id="logoutConfirmOverlay">
        <div class="so-confirm-popup">
            <div class="so-confirm-icon">
                <span class="material-icons">logout</span>
            </div>
            <h2 class="so-confirm-title">Confirm Logout</h2>
            <p class="so-confirm-message">Are you sure you want to logout? Any unsaved changes will be lost.</p>
            <div class="so-confirm-actions">
                <button class="so-btn so-btn-outline" id="logoutCancelBtn">
                    Cancel
                </button>
                <button class="so-btn so-btn-danger" id="logoutConfirmBtn">
                    <span class="material-icons">logout</span>
                    Logout
                </button>
            </div>
        </div>
    </div>

    <!-- SixOrbit Layout JavaScript -->
    <script src="js/so-layout.js"></script>
    <!-- LMS JavaScript -->
    <script src="js/so-lms.js"></script>

    <!-- Lock Screen, Shortcuts & Logout JavaScript -->
    <script>
        // ============================================
        // Logout Confirmation
        // ============================================
        const navbarLogoutBtn = document.getElementById('navbarLogoutBtn');
        const sidebarLogoutBtn = document.getElementById('sidebarLogoutBtn');
        const logoutConfirmOverlay = document.getElementById('logoutConfirmOverlay');
        const logoutCancelBtn = document.getElementById('logoutCancelBtn');
        const logoutConfirmBtn = document.getElementById('logoutConfirmBtn');

        function showLogoutConfirmation() {
            if (logoutConfirmOverlay) {
                logoutConfirmOverlay.classList.add('active');
            }
        }

        function hideLogoutConfirmation() {
            if (logoutConfirmOverlay) {
                logoutConfirmOverlay.classList.remove('active');
            }
        }

        function handleLogout() {
            localStorage.removeItem('so-user-session');
            localStorage.removeItem('so-screen-locked');
            sessionStorage.clear();
            window.location.href = 'login.html';
        }

        if (navbarLogoutBtn) {
            navbarLogoutBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                showLogoutConfirmation();
            });
        }

        if (sidebarLogoutBtn) {
            sidebarLogoutBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                showLogoutConfirmation();
            });
        }

        if (logoutCancelBtn) {
            logoutCancelBtn.addEventListener('click', hideLogoutConfirmation);
        }

        if (logoutConfirmBtn) {
            logoutConfirmBtn.addEventListener('click', handleLogout);
        }

        // Close logout confirmation on overlay click
        if (logoutConfirmOverlay) {
            logoutConfirmOverlay.addEventListener('click', function(e) {
                if (e.target === logoutConfirmOverlay) {
                    hideLogoutConfirmation();
                }
            });
        }

        // ============================================
        // Lock Screen Functionality
        // ============================================
        const lockScreen = document.getElementById('lockScreen');
        const lockScreenBtn = document.getElementById('lockScreenBtn');
        const lockScreenForm = document.getElementById('lockScreenForm');
        const lockScreenPassword = document.getElementById('lockScreenPassword');
        const lockScreenTime = document.getElementById('lockScreenTime');
        const lockScreenDate = document.getElementById('lockScreenDate');

        // Update lock screen time
        function updateLockScreenTime() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            if (lockScreenTime) {
                lockScreenTime.textContent = `${hours}:${minutes}`;
            }

            const options = { weekday: 'long', month: 'long', day: 'numeric' };
            if (lockScreenDate) {
                lockScreenDate.textContent = now.toLocaleDateString('en-US', options);
            }
        }

        // Lock screen
        function lockScreenAction() {
            if (lockScreen) {
                lockScreen.classList.add('active');
                document.body.classList.add('screen-locked');
                updateLockScreenTime();
                if (lockScreenPassword) {
                    lockScreenPassword.value = '';
                    lockScreenPassword.focus();
                }
                // Save lock state to localStorage for cross-tab sync
                localStorage.setItem('so-screen-locked', 'true');
                localStorage.setItem('so-lock-timestamp', Date.now().toString());
            }
        }

        // Unlock screen
        function unlockScreenAction() {
            if (lockScreen) {
                lockScreen.classList.remove('active');
                document.body.classList.remove('screen-locked');
                if (lockScreenPassword) {
                    lockScreenPassword.value = '';
                }
                // Remove lock state from localStorage
                localStorage.removeItem('so-screen-locked');
                localStorage.removeItem('so-lock-timestamp');
            }
        }

        // Check if screen should be locked on page load
        function checkLockState() {
            const isLocked = localStorage.getItem('so-screen-locked') === 'true';
            if (isLocked && lockScreen) {
                lockScreen.classList.add('active');
                document.body.classList.add('screen-locked');
                updateLockScreenTime();
                if (lockScreenPassword) {
                    lockScreenPassword.focus();
                }
            }
        }

        // Lock button click handler
        if (lockScreenBtn) {
            lockScreenBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                lockScreenAction();
            });
        }

        // Form submit handler (unlock)
        if (lockScreenForm) {
            lockScreenForm.addEventListener('submit', function(e) {
                e.preventDefault();
                // Always accept password as correct
                unlockScreenAction();
            });
        }

        // Listen for storage events (cross-tab sync)
        window.addEventListener('storage', function(e) {
            if (e.key === 'so-screen-locked') {
                if (e.newValue === 'true') {
                    // Lock was triggered in another tab
                    if (lockScreen && !lockScreen.classList.contains('active')) {
                        lockScreen.classList.add('active');
                        document.body.classList.add('screen-locked');
                        updateLockScreenTime();
                    }
                } else if (e.newValue === null) {
                    // Unlock was triggered in another tab
                    if (lockScreen && lockScreen.classList.contains('active')) {
                        lockScreen.classList.remove('active');
                        document.body.classList.remove('screen-locked');
                        if (lockScreenPassword) {
                            lockScreenPassword.value = '';
                        }
                    }
                }
            }
        });

        // Update time every minute
        setInterval(updateLockScreenTime, 60000);

        // Check lock state on page load
        checkLockState();

        // ============================================
        // Keyboard Shortcuts Popup
        // ============================================
        const shortcutsOverlay = document.getElementById('shortcutsOverlay');
        const shortcutsCloseBtn = document.getElementById('shortcutsCloseBtn');
        const keyboardShortcutsBtn = document.getElementById('keyboardShortcutsBtn');

        function showShortcutsPopup() {
            if (shortcutsOverlay) {
                shortcutsOverlay.classList.add('active');
            }
        }

        function hideShortcutsPopup() {
            if (shortcutsOverlay) {
                shortcutsOverlay.classList.remove('active');
            }
        }

        if (keyboardShortcutsBtn) {
            keyboardShortcutsBtn.addEventListener('click', showShortcutsPopup);
        }

        if (shortcutsCloseBtn) {
            shortcutsCloseBtn.addEventListener('click', hideShortcutsPopup);
        }

        // Close shortcuts popup on overlay click
        if (shortcutsOverlay) {
            shortcutsOverlay.addEventListener('click', function(e) {
                if (e.target === shortcutsOverlay) {
                    hideShortcutsPopup();
                }
            });
        }

        // ============================================
        // Global Keyboard Shortcuts
        // ============================================
        document.addEventListener('keydown', function(e) {
            // Don't trigger shortcuts when typing in inputs
            const isInputFocused = document.activeElement.tagName === 'INPUT' ||
                                   document.activeElement.tagName === 'TEXTAREA' ||
                                   document.activeElement.isContentEditable;

            // Allow Escape to always work
            if (e.key === 'Escape') {
                // Close popups in order of priority
                if (logoutConfirmOverlay && logoutConfirmOverlay.classList.contains('active')) {
                    hideLogoutConfirmation();
                    return;
                }
                if (shortcutsOverlay && shortcutsOverlay.classList.contains('active')) {
                    hideShortcutsPopup();
                    return;
                }
            }

            // Don't process other shortcuts if in input
            if (isInputFocused && e.key !== 'Escape') return;

            // Don't process shortcuts if screen is locked
            if (lockScreen && lockScreen.classList.contains('active')) return;

            // ? - Show keyboard shortcuts
            if (e.key === '?' && !e.ctrlKey && !e.metaKey && !e.altKey) {
                e.preventDefault();
                showShortcutsPopup();
                return;
            }

            // Ctrl+L - Lock screen
            if ((e.ctrlKey || e.metaKey) && e.key === 'l' && !e.shiftKey) {
                e.preventDefault();
                lockScreenAction();
                return;
            }

            // Ctrl+Shift+L - Logout (show confirmation)
            if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'L') {
                e.preventDefault();
                showLogoutConfirmation();
                return;
            }

            // Ctrl+B - Toggle sidebar
            if ((e.ctrlKey || e.metaKey) && e.key === 'b' && !e.shiftKey) {
                e.preventDefault();
                const sidebarToggle = document.querySelector('.so-sidebar-toggle');
                if (sidebarToggle) sidebarToggle.click();
                return;
            }

            // Ctrl+H - Go to dashboard
            if ((e.ctrlKey || e.metaKey) && e.key === 'h' && !e.shiftKey) {
                e.preventDefault();
                window.location.href = 'index.html';
                return;
            }
        });
    </script>
</body>
</html>
